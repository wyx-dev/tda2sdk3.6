
/*******************************************************************************
*  file name: DSP_common.cfg
*  DSP Cache configuration
*  Includes in both the DSP core 1 and core 2 specific cfg files
*
*******************************************************************************/

if (java.lang.System.getenv("RADAR_ONLY") == "no")
{
    xdc.loadPackage('ti.xdais');
}

var Program     = xdc.useModule("xdc.cfg.Program");

xdc.useModule('xdc.runtime.knl.Semaphore').Proxy = xdc.useModule('ti.sysbios.xdcruntime.SemProcessSupport');

var Memory = xdc.useModule('xdc.runtime.Memory');

var Cache = xdc.useModule('ti.sysbios.family.c66.Cache');
Cache.initSize.l1pSize = Cache.L1Size_32K;
Cache.initSize.l1dSize = Cache.L1Size_32K;
Cache.initSize.l2Size  = Cache.L2Size_32K;

/* Disabling Cache for the memory region 0-0x80000000 is TBD */

/* Configure MARs, by default cache is enabled for the entire memory region */
for (var i = 0; i < Program.cpu.memoryMap.length; i++)
{
   memSegment = Program.cpu.memoryMap[i];
   Cache.setMarMeta(memSegment.base, memSegment.len, Cache.Mar_ENABLE | Cache.PFX);
}

for (var i = 0; i < Program.cpu.memoryMap.length; i++)
{
  memSegment = Program.cpu.memoryMap[i];

  if ((memSegment.name == "SR0") ||
      (memSegment.name == "REMOTE_LOG_MEM") ||
      (memSegment.name == "LINK_STATS_MEM") ||
      (memSegment.name == "SYSTEM_IPC_SHM_MEM") ||
      (memSegment.name == "OPENVX_SHM_MEM"))
     {
        Cache.setMarMeta(memSegment.base, memSegment.len, Cache.Mar_DISABLE);
     }
}
var LINK_STATS_MEM = Program.cpu.memoryMap['LINK_STATS_MEM'];
Program.global.gXdcLinkStatsAddr = LINK_STATS_MEM.base;
Program.global.gXdcLinkStatsSize = LINK_STATS_MEM.len;

var ECM       = xdc.useModule ("ti.sysbios.family.c64p.EventCombiner");
var C64_Hwi   = xdc.useModule ("ti.sysbios.family.c64p.Hwi");

ECM.eventGroupHwiNum[0] = 7;
ECM.eventGroupHwiNum[1] = 8;
ECM.eventGroupHwiNum[2] = 9;
ECM.eventGroupHwiNum[3] = 10;

var InitXbar    = xdc.useModule("ti.sysbios.family.shared.vayu.IntXbar");

/***********************************************
 *         Reset Module Configuration          *
 ***********************************************/
if (java.lang.System.getenv("ECC_FFI_INCLUDE") == "yes")
{
    var Reset = xdc.useModule('xdc.runtime.Reset');
    Reset.fxns[Reset.fxns.length++] = "&Utils_dspEccEnable";
}


